<!DOCTYPE html>
<html>
<head>
<title>ソーシャルコンセント</title>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1">
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.8.1/jquery.min.js"></script>
<script src="/js/jquery.json-2.3.min.js"></script>
<script
	src="//ajax.aspnetcdn.com/ajax/jquery.mobile/1.2.0/jquery.mobile-1.2.0.min.js"></script>
<link rel="stylesheet" href="/css/odenki-theme.min.css" />
<link rel="stylesheet"
	href="http://ajax.aspnetcdn.com/ajax/jquery.mobile/1.2.0/jquery.mobile.structure-1.2.0.min.css" />
<script src="/js/header.js"></script>
</head>
<body>
	<div data-role="page">
		<div data-role="header">
			<h1>ソーシャルコンセント</h1>
		</div>

		<div data-role="content">
			<p>みんなでおでんきプロジェクトのソーシャルコンセントへようこそ。</p>
			<p class="notloggedin">
				あたなみんなでおでんきにログインしていません。ログインしていない場合は最大10分間の利用が可能です。</p>
			<p class="loggedin">
				<span id="odenkiName"></span>さん、おかえりなさい。
			</p>
			<p>次のソーシャルコンセントを利用しようとしています。
				ソーシャルコンセントが認識できない場合はもう一度ソーシャルコンセントに携帯電話をかざして下さい。</p>
			<table>
				<tr>
					<td>コンセント名</td>
					<td><input readonly="true" placeholder="コンセント名"
						id="outletName" value="なし"></input></td>
					<td></td>
				</tr>
				<tr>
					<td>コンセントID</td>
					<td><input readonly="true" placeholder="コンセントID"
						value="認識できません" id="outletId"></input></td>
					<td></td>
				</tr>
				<tr>
					<td>最大利用時間</td>
					<td><input readonly="true" placeholder="最大利用時間" value="10"
						id="outletDuration" data-inline="true"></td>
					<td>分</td>
				</tr>
			</table>
			<a class="notloggedin" data-role="button" href="/html/settings.html"
				data-ajax="false">みんなでおでんきにログインする</a> <a class="loggedin"
				data-role="button">このソーシャルコンセントを使う</a>
		</div>
	</div>
	<script>
		$.getJSON("/api/outlet/status", {}, function(data) {
			if (data.result.OdenkiUser) {
				lib.ui.showElement(".loggedin");
				lib.ui.hideElement(".notloggedin");
				$("#odenkiName").text(data.result.OdenkiUser.odenkiName);
			} else {
				lib.ui.hideElement(".loggedin");
				lib.ui.showElement(".notloggedin");
			}
			if (data.result.Outlet){
				$("#outletName").val(data.result.Outlet.outletName);
				$("#outletId").val(data.result.Outlet.outletId);
				$("#outletDuration").val(data.result.Outlet.outletDuration);
			}
		});
		function notloggedin() {
			lib.ui.showElement(".notloggedin");
			lib.ui.hideElement(".loggedin");
		}
		function loggedin() {
		}
	</script>
</body>
</html>
